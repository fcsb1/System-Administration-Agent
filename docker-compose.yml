version: '3.8'

services:
  ollama:
    build:
      context: .
      dockerfile: Dockerfile.ollama
    container_name: ollama
    ports:
      - "11434:11434"

  mcp-server:
    build:
      context: .
      dockerfile: Dockerfile.mcp
    container_name: mcp-server
    ports:
      - "8000:8000"
    volumes:
      - ./PartajatCuAgentul:/managed_folder:ro
      - ./logs:/app/logs

  agent:
    build:
      context: .
      dockerfile: Dockerfile.agent
    container_name: agent
    ports:
      - "8080:8080"
    depends_on:
      - ollama
      - mcp-server
    environment:
      - ADK_MODEL_PROVIDER=litellm
      - LITELLM_MODEL_NAME=ollama_chat/qwen3:14b
      - OLLAMA_HOST=http://ollama:11434      # <--- ADD THIS
      - OLLAMA_API_BASE=http://ollama:11434